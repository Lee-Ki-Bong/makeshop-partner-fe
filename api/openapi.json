{"openapi":"3.0.0","paths":{"/admin/oauth/start":{"get":{"description":"\nOAuth 인가 플로우를 시작합니다.\n\n클라이언트 IP, User-Agent, deviceId 등을 기반으로\nPKCE 코드 챌린지 및 state를 생성하여 Auth Server로 이동할 URL을 반환합니다.\n    ","operationId":"StartOAuthController_startOauth","parameters":[{"name":"deviceId","required":true,"in":"query","description":"디바이스 고유 식별자(브라우저 또는 앱 단위). 클라이언트가 생성해 전달합니다.","schema":{"example":"c6e54331-47c6-4bf5-8e1a-1b2cafb0df91","type":"string"}},{"name":"screenHint","required":false,"in":"query","description":"IDP UI 힌트 (로그인/회원가입 선택). screen_hint=signup 시 회원가입 UI 표시.","schema":{"example":"signup","type":"string"}}],"responses":{"200":{"description":"OAuth 시작 URL 및 관련 값들이 정상적으로 반환됩니다.","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/ApiResponseDto"},{"properties":{"data":{"$ref":"#/components/schemas/StartOAuthResponseDto"}}}],"example":{"success":true,"operation":"operation_name","code":"OK","message":"요청이 성공적으로 처리되었습니다.","data":{"authorizeUrl":"http://local-auth:3001/oauth2/authorize?client_id=xxx&state=yyy&code_challenge=zzz"}}}}}}},"summary":"OAuth 시작 (Authorization Code + PKCE)","tags":["파트너 어드민 Auth"]}},"/admin/logout":{"post":{"description":"\n세션을 제거하고, 인터셉터를 통해 브라우저의 세션 쿠키(session_id)를 삭제합니다.\n\n응답 자체는 JSON을 반환하지만, 실제 쿠키 삭제는 LogoutCookieClearInterceptor에서 처리됩니다.\n\n- 본 API의 성공 응답은 **서버 세션 무효화 완료**를 의미합니다.\n- 브라우저 쿠키 삭제는 HTTP 응답 헤더(Set-Cookie)를 통해 처리되며,\n  클라이언트의 추가 작업은 필요하지 않습니다.\n  ","operationId":"LogoutController_logout","parameters":[],"responses":{"200":{"description":"정상적으로 로그아웃되었습니다.","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/ApiResponseDto"},{"properties":{"data":{"$ref":"#/components/schemas/LogoutResponseDto"}}}],"example":{"success":true,"operation":"operation_name","code":"OK","message":"요청이 성공적으로 처리되었습니다.","data":{"success":true}}}}}}},"summary":"로그아웃","tags":["파트너 어드민 Auth"]}},"/admin/user/registration":{"post":{"description":"사용자가 이 서비스를 처음 이용할 때 호출되는 API입니다.\n해당 요청이 오면 IDP userinfo를 조회하여 BFF DB에 유저를 생성하고, 파트너 서비스 이용 동의를 함께 저장합니다.","operationId":"UserRegistrationController_register","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePartnerAgreementDto"}}}},"responses":{"200":{"description":"서비스 최초 등록에 성공","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/ApiResponseDto"},{"properties":{"data":{"$ref":"#/components/schemas/PartnerRegistrationResponseDto"}}}]}}}}},"summary":"서비스 최초 등록 (동의 포함)","tags":["파트너 어드민 가입"]}},"/admin/user":{"get":{"operationId":"AdminUserController_getUser","parameters":[],"responses":{"200":{"description":"조회 성공","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponseDto"}}}}},"security":[{"bearer":[]}],"summary":"사용자 조회","tags":["파트너 어드민 회원 정보"]}},"/admin/user/state":{"get":{"operationId":"AdminUserController_getUserState","parameters":[],"responses":{"200":{"description":"조회 성공","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserStateResponseDto"}}}}},"security":[{"bearer":[]}],"summary":"사용자 상태 조회","tags":["파트너 어드민 회원 정보"]}},"/admin/me":{"get":{"description":" \n현재 세션을 기반으로 사용자 정보를 조회합니다.\n\n- 인증된 요청 주체의 “현재 상태 스냅샷”을 반환 반환합니다.\n- 인증 외에 판단·차단·흐름 제어는 하지 않는다\n    ","operationId":"MeController_getMe","parameters":[],"responses":{"200":{"description":"현재 로그인 사용자의 도메인 상태 컨텍스트 조회","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/ApiResponseDto"},{"properties":{"data":{"$ref":"#/components/schemas/MeResponseDto"}}}]}}}},"401":{"description":"세션이 없거나 만료된 경우 (Unauthorized)"}},"summary":"사용자 현재 상태 스냅샷","tags":["파트너 어드민 현재 상태 스냅샷"]}}},"info":{"title":"파트너 어드민","description":"파트너 어드민 설명","version":"1.0.0","contact":{}},"tags":[],"servers":[{"url":"http://localhost:3000/api"}],"components":{"schemas":{"ApiResponseDto":{"type":"object","properties":{"success":{"type":"boolean","example":true,"description":"요청 성공 여부 (비즈니스 기준)"},"operation":{"type":"string","example":"operation_name","description":"수행된 작업(operation) 이름"},"code":{"type":"string","example":"CODE","description":"응답의 의미를 식별하는 코드 (성공/실패 공용)"},"message":{"type":"string","example":"요청이 성공적으로 처리되었습니다.","description":"사람에게 보여줄 메시지 (로직에서 사용 금지)"},"data":{"type":"object","description":"응답 데이터 또는 에러 상세 정보","nullable":true}},"required":["success","operation","message"]},"StartOAuthResponseDto":{"type":"object","properties":{"authorizeUrl":{"type":"string","description":"클라이언트가 이동해야 할 OAuth 인가 엔드포인트 URL (PKCE 포함)","example":"http://localhost:3001/oauth/authorize?client_id=partner-center&redirect_uri=http://localhost:3002/oauth/callback&state=8c4f0e20&code_challenge=vsh1d9k2&code_challenge_method=S256"}},"required":["authorizeUrl"]},"StartOAuthRequestDto":{"type":"object","properties":{"deviceId":{"type":"string","description":"디바이스 고유 식별자(브라우저 또는 앱 단위). 클라이언트가 생성해 전달합니다.","example":"c6e54331-47c6-4bf5-8e1a-1b2cafb0df91"},"screenHint":{"type":"string","description":"IDP UI 힌트 (로그인/회원가입 선택). screen_hint=signup 시 회원가입 UI 표시.","example":"signup"}},"required":["deviceId"]},"LogoutResponseDto":{"type":"object","properties":{"success":{"type":"boolean","example":true}},"required":["success"]},"PartnerRegistrationResponseDto":{"type":"object","properties":{"partnerId":{"type":"number","description":"생성된 파트너 식별자","example":12345},"status":{"type":"string","description":"파트너 회원가입 완료 후 상태","example":"REGISTERED","enum":["REGISTERED"]}},"required":["partnerId","status"]},"CreatePartnerAgreementDto":{"type":"object","properties":{"termsOfUse":{"type":"boolean","example":false},"privacyPolicy":{"type":"boolean","example":false},"marketingSms":{"type":"boolean","example":false},"marketingEmail":{"type":"boolean","example":false}},"required":["termsOfUse","privacyPolicy","marketingSms","marketingEmail"]},"UserResponseDto":{"type":"object","properties":{"userId":{"type":"string","description":"사용자 고유 ID","example":"12345"},"loginUid":{"type":"string","description":"로그인 UID (외부 인증 시스템 ID)","example":"user_abc123"},"name":{"type":"string","description":"사용자 이름","example":"홍길동"},"email":{"type":"string","description":"이메일 주소","example":"user@example.com"},"phone":{"type":"string","description":"휴대폰 번호","example":"010-1234-5678"}},"required":["userId","loginUid","name","email","phone"]},"DisplayStatus":{"type":"string","enum":["USER_ONLY","PENDING","PENDING_APPROVAL","ACTIVE","REJECTED","REAPPROVAL_REQUEST","REAPPROVAL_REJECTED","SUSPENDED","WITHDRAWAL_REQUEST","WITHDRAWAL_HOLD","WITHDRAWAL_COMPLETED"],"description":"사용자 상태"},"UserStateResponseDto":{"type":"object","properties":{"userId":{"type":"string","description":"사용자 고유 ID","example":"12345"},"loginUid":{"type":"string","description":"로그인 UID (외부 인증 시스템 ID)","example":"user_abc123"},"name":{"type":"string","description":"사용자 이름","example":"홍길동"},"email":{"type":"string","description":"이메일 주소","example":"user@example.com"},"phone":{"type":"string","description":"휴대폰 번호","example":"010-1234-5678"},"displayStatus":{"description":"사용자 상태","example":"REJECTED","allOf":[{"$ref":"#/components/schemas/DisplayStatus"}]},"reason":{"type":"string","description":"상태 변경 사유","example":"사업자 정보 미입력.","nullable":true}},"required":["userId","loginUid","name","email","phone","displayStatus"]},"MeIdentityDto":{"type":"object","properties":{"loginUid":{"type":"object","example":"partner@example.com","nullable":true,"description":"로그인 식별자 (아직 사용자 확정 전일 수 있음)"}},"required":["loginUid"]},"MeFlagsDto":{"type":"object","properties":{"hasPartner":{"type":"boolean","example":false,"description":"파트너가 생성되어 있는지 여부"},"agreed":{"type":"boolean","example":false,"description":"필수 약관 동의가 완료되었는지 여부"}},"required":["hasPartner","agreed"]},"MeResponseDto":{"type":"object","properties":{"user":{"description":"사용자 식별 최소 정보","allOf":[{"$ref":"#/components/schemas/MeIdentityDto"}]},"flags":{"description":"도메인 상태 플래그","allOf":[{"$ref":"#/components/schemas/MeFlagsDto"}]}},"required":["user","flags"]}}}}